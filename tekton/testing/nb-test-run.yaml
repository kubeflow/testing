apiVersion: tekton.dev/v1alpha1
kind: PipelineRun
metadata:
  name: run-testing
  namespace: tektoncd
spec:
  workspaces:
  - name: junit-artifacts
    persistentVolumeClaim:
      claimName: junit-pvc
  resources:
  - name: examples-repo
    resourceSpec:
      type: git
      params:
      - name: url
        value: https://github.com/kubeflow/examples.git
      - name: revision
        value: refs/pull/764/head
  - name: testing-repo
    resourceSpec:
      type: git
      params:
      - name: url
        value: https://github.com/kubeflow/testing.git
      - name: revision
        value: refs/pull/<pull-number>/head
  - name: gcs-test-repo
    resourceSpec:
      type: storage
      params:
      - name: type
        value: gcs
      - name: location
        value: gs://kubeflow-ci
      - name: dir
        value: "y"
  pipelineSpec:
    workspaces:
    - name: junit-artifacts
    resources:
    - name: examples-repo
      type: git
    - name: testing-repo
      type: git
    - name: gcs-test-repo
      type: storage
    tasks:
            # - name: xgboost-synthetic
            #   workspaces:
            #   - name: junit-artifacts
            #     workspace: junit-artifacts
            #   resources:
            #     inputs:
            #     - name: examples-repo
            #       resource: examples-repo
            #     - name: kf-testing-repo
            #       resource: testing-repo
            #     outputs:
            #     - name: gcs-test-repo
            #       resource: gcs-test-repo
            #   taskRef:
            #     name: notebook-test
            #   params:
            #   - name: notebook-path
            #     value: 'kubeflow/examples/xgboost_synthetic/build-train-deploy.ipynb'
            #   - name: junit-path
            #     value: /workspace/outputs/artifacts/junit_xgboost-synthetic.xml
    - name: mnist-gcp
      workspaces:
      - name: junit-artifacts
        workspace: junit-artifacts
      resources:
        inputs:
        - name: examples-repo
          resource: examples-repo
        - name: kf-testing-repo
          resource: testing-repo
        outputs:
        - name: gcs-test-repo
          resource: gcs-test-repo
      taskRef:
        name: notebook-test
      params:
      - name: notebook-path
        value: 'kubeflow/examples/mnist/mnist_gcp.ipynb'
      - name: junit-path
        value: /workspace/outputs/artifacts/junit_mnist-gcp.xml
