# This is intended to be a reusable pipeline for running py tests.
# Ideally this will eventually run unittests as well as lint.
apiVersion: tekton.dev/v1alpha1
kind: Pipeline
metadata:
  name: py-lint-unittests
spec:
  params:
  - name: artifacts-gcs
    type: string
    description: GCS bucket and directory artifacts will be uploaded to. Should be
      in the form of 'gs://'
  resources:
  - name: testing-repo
    type: git
  tasks:
  - name: py-lint
    params:
    - name: artifacts-gcs
      value: "$(params.artifacts-gcs)"
    resources:
      inputs:
      - name: testing-repo
        resource: testing-repo
    taskRef:
      name: py-lint
  - name: py-test
    params:
    - name: artifacts-gcs
      value: "$(params.artifacts-gcs)"
    resources:
      inputs:
      - name: testing-repo
        resource: testing-repo
    taskRef:
      name: py-test
    runAfter:
      - py-lint
